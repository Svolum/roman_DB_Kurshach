<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>DB Coursework</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .selected {
      background-color: #0d6efd !important;
      color: white !important;
    }
    .selected:hover {
      background-color: #0b5ed7 !important;
      color: white !important;
    }
    #controls {
      display: none;
    }
    #form-container {
      display: none;
    }
    .table-hover tbody tr:hover {
      background-color: rgba(13, 110, 253, 0.1);
      cursor: pointer;
    }
    #phone-controls {
      display: none;
    }
  </style>
</head>
<body class="bg-light">

<div class="container mt-5">

  <!-- LOGIN -->
  <div id="login" class="card mx-auto" style="max-width: 400px;">
    <div class="card-body">
      <h4 class="card-title mb-3">Вход</h4>
      <div class="mb-3">
        <input id="loginName" class="form-control" placeholder="Логин">
      </div>
      <div class="mb-3">
        <input id="loginPass" type="password" class="form-control" placeholder="Пароль">
      </div>
      <button class="btn btn-primary w-100" onclick="doLogin()">Войти</button>
    </div>
  </div>

  <!-- MENU -->
  <div id="menu" style="display:none">
    <div class="card mt-4">
      <div class="card-body">
        <h5 class="mb-3">Меню</h5>
        <div id="adminMenu" class="mb-3">
          <button class="btn btn-outline-primary me-2" onclick="loadEmployees()">Сотрудники</button>
          <button class="btn btn-outline-primary me-2" onclick="loadPositions()">Должности</button>
          <button class="btn btn-outline-primary me-2" onclick="loadDepartments()">Подразделения</button>
          <button class="btn btn-outline-primary me-2" onclick="loadPhones()">Телефоны сотрудников</button>
        </div>
        <div class="mb-3">
          <button class="btn btn-outline-success me-2" onclick="loadPhoneReport()">Телефонный справочник</button>
          <div class="mb-3 d-flex align-items-center gap-2">
            <input
              id="experienceInput"
              type="number"
              class="form-control"
              style="max-width: 120px"
              placeholder="Стаж ≤"
              min="0"
            >
            <button class="btn btn-outline-success" onclick="loadExperienceReport()">
              Показать
            </button>
          </div>
          <button class="btn btn-outline-success" onclick="loadAcademicReport()">Учёные степени</button>
        </div>
        <div id="export-buttons" class="mt-3" style="display:none">
          <button class="btn btn-outline-success" onclick="exportExcel()">Excel</button>
        </div>
      </div>
    </div>

    <!-- Таблица -->
    <div class="card mt-4">
      <div class="card-body">
        <!-- Для телефонов: выбор сотрудника -->
        <div id="phone-selector" style="display: none;" class="mb-3">
          <label class="form-label">Выберите сотрудника:</label>
          <select id="employee-select" class="form-select" onchange="onEmployeeSelected()">
            <option value="">-- Выберите сотрудника --</option>
          </select>
        </div>

        <!-- Кнопки управления (изначально скрыты) -->
        <div id="controls" class="mb-3">
          <button id="add-btn" class="btn btn-success" onclick="showAddForm()">Добавить</button>
          <button id="edit-btn" class="btn btn-warning" onclick="showEditForm()" disabled>Изменить</button>
          <button id="delete-btn" class="btn btn-danger" onclick="deleteSelected()" disabled>Удалить</button>
        </div>

        <!-- Кнопки управления для телефонов (изначально скрыты) -->
        <div id="phone-controls" class="mb-3">
          <button id="add-phone-btn" class="btn btn-success" onclick="showAddPhoneForm()">Добавить телефон</button>
          <button id="edit-phone-btn" class="btn btn-warning" onclick="showEditPhoneForm()" disabled>Изменить</button>
          <button id="delete-phone-btn" class="btn btn-danger" onclick="deleteSelectedPhone()" disabled>Удалить</button>
        </div>
        
        <div id="table"></div>
      </div>
    </div>

    <!-- Форма для добавления/редактирования (под таблицей) -->
    <div id="form-container" class="card mt-4">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 id="form-title" class="card-title mb-0">Добавить запись</h5>
          <button type="button" class="btn-close" aria-label="Закрыть" onclick="hideForm()"></button>
        </div>
        <form id="data-form">
          <!-- Поля будут генерироваться динамически -->
        </form>
        <div class="mt-3">
          <button id="form-submit" class="btn btn-primary">Сохранить</button>
          <button type="button" onclick="hideForm()" class="btn btn-secondary">Отмена</button>
        </div>
      </div>
    </div>
  </div>

</div>

<script src="scripts.js"></script>
</body>
</html>